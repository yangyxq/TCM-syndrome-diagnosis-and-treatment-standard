---
output: word_document
---
```{r setup, include=FALSE}

library(ggplot2)
library(reshape2)
library(knitr)
library(xtable)
library(dplyr)
library(scales)
library(ggthemes)
library(grid)
library(xlsx)
##设置全局选项
knit_hooks$set(margin = function(before, options, envir){
  if(before)
    par(mar = c(4, 4, 1, 0.4)) else NULL
})
opts_chunk$set(comment=NA, echo = FALSE, message=FALSE, warning=FALSE, yeshzs='asis', margin=TRUE)
options(scipen=200, digits=2)
setwd("C:\\Users\\zzslkbc\\Desktop\\xuexi\\2019数据")
xcdb <-read.xlsx2("妇科痛经适用性调查.xlsx", sheetName = "Sheet0")
fksysj <-read.xlsx2("妇科痛经适用性调查.xlsx", sheetName ="Sheet0")
DN <- "妇科痛经"
```

---
title: "2018年`r unique(DN)`标准适用性评价统计报告"
output: word_document
---

# 适用性评价

## 一

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;标准适用性评价包括被调查医生对标准的熟悉和使用情况、标准的质量水平、应用情况、意见建议等内容。

##（一）基本信息——指南熟悉和使用情况

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;分析被调查医生对“`r DN`”标准的熟悉程度和使用情况。

### 1.整体情况  

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;分析全部医生整体对标准的熟悉和使用情况，熟悉情况和使用情况的评分如下图所示。（见图1）

```{r 图1,echo=FALSE,message=FALSE,fig.height=8,fig.width=6}

aa <- colnames(xcdb)
bb <- aa[grepl("评分", aa)]
bb <- as.data.frame(bb)
bb <- as.data.frame(bb[(bb[, 1] != "是否熟悉修订前中医病证诊断疗效标准的内容的评分"), 1])
bb <- as.data.frame(bb[(bb[, 1] != "是否使用过修订前中医病证诊断疗效标准内容的评分"), 1])
names(bb) <- "问题合集"
names.a<-bb$问题合集

xxx1 <- gsub("奟", replacement =DN, "奟标准使用的病名是否准确的评分")
aaa1 <- which(names.a==xxx1)
xxx2<- gsub("奟", replacement =DN, "奟标准修订草案的疗效评价方法是否合理的评分")
aaa2 <- which(names.a==xxx2)
xxx3 <- gsub("奟", replacement =DN, "奟标准的适用范围是否明确评分")
aaa3 <- which(names.a==xxx3)
xxx4 <- gsub("奟", replacement =DN, "奟标准的整体适用性评分")
aaa4 <- which(names.a==xxx4)

sxdc <- as.data.frame(xcdb[,c(1,5,8,10)])
sxdc1<- as.data.frame(xcdb[,c(1,8,10)])
names(sxdc) <- c('编号','职称','熟悉情况','使用情况')
names(sxdc1) <- c('编号','熟悉情况','使用情况')

sxdc<-sxdc[(sxdc$熟悉情况!=""),]
sxdc1<-sxdc1[(sxdc1$熟悉情况!=""),]
www <- c('熟悉情况','使用情况')

xctm <- subset(xcdb,select = names.a)
sxdc2 <- melt(sxdc1,measure.vars = www)
sxdc2$value <- as.character(sxdc2$value)
sxdc2 <- as.data.frame(table(sxdc2[,c(2,3)]))
sxdc2$per <- round(sxdc2$Freq/nrow(sxdc1),4)*100
sxdc2$per2 <- round(sxdc2$Freq/nrow(sxdc1),4)
sxdc2$value <- factor(sxdc2$value,order =TRUE,levels = c(1:7))


p <- ggplot(sxdc2,aes(x =value,y =per2,fill = value))+
    labs(xlab = '',ylab = '频数')+
    scale_y_continuous(labels = percent,limits = c(0, 0.6))+
    geom_bar(stat = 'identity',position = 'dodge')+
    theme_few()+
    theme(text=element_text(size=12),plot.title=element_text(size=3))+
    geom_text(aes(label=paste(Freq,'(',per,'%',')')),size=3,position=position_dodge(width=0.4), vjust=-0.75)+
    facet_wrap(~variable,ncol =1)+
    scale_fill_discrete(name  ="评分")
p+ylab('频率')+xlab(" ")
```

```{r,echo=FALSE,message=FALSE}

sxdc$熟悉情况<-as.character(sxdc$熟悉情况)
sxdc$使用情况<-as.character(sxdc$使用情况)
sxdc$熟悉情况<-as.numeric(sxdc$熟悉情况)
sxdc$使用情况<-as.numeric(sxdc$使用情况)

for (i in 1:length(sxdc$熟悉情况)) {
  if(sxdc$熟悉情况[i]>=6){
  sxdc$熟悉情况[i]="是"
  }
}
for (i in 1:length(sxdc$熟悉情况)) {
  if(sxdc$熟悉情况[i]<=5){
  sxdc$熟悉情况[i]="否"
  }
}
for (i in 1:length(sxdc$使用情况)) {
  if(sxdc$使用情况[i]>=6){
  sxdc$使用情况[i]="是"
  }
}
for (i in 1:length(sxdc$使用情况)) {
  if(sxdc$使用情况[i]<=5){
  sxdc$使用情况[i]="否"
  }
}
```
 

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;认定“熟悉情况评分”为6分和7分的医生为熟悉标准，认定“使用情况评分”为6分和7分的医生为使用标准。其中熟悉标准的医生为`r sum(sxdc$熟悉情况=='是')`人，占`r round(sum(sxdc$熟悉情况=='是')/nrow(sxdc),3)*100`%；使用指南的医生为`r sum(sxdc$使用情况=='是')`人，占`r round(sum(sxdc$使用情况=='是')/nrow(sxdc),3)*100`%。（见图2）


```{r,图2,echo=FALSE,message=FALSE}
sxdc1 <- melt(sxdc,id = '编号',measure.vars = c('熟悉情况','使用情况'))     ##将measure变成长数据
sxdc1$value <- factor(sxdc1$value,order =TRUE,levels = c('是','否'))
sxdc$使用情况 <- factor(sxdc$使用情况,order =TRUE,levels = c('是','否'))
sxdc$熟悉情况 <- factor(sxdc$熟悉情况,order =TRUE,levels = c('是','否'))

sxdc2 <- as.data.frame(table(sxdc1[,c(2,3)]))
sxdc2$per <- round(sxdc2$Freq/nrow(sxdc),2)       ##几位小数
sxdc2$per2 <- round(sxdc2$Freq/nrow(sxdc),2)*100
  
p <- ggplot(sxdc2,aes(x =variable,y =per,fill = value))+
    geom_bar(stat = 'identity',position = 'dodge')+
    scale_y_continuous(labels = percent)+
    theme(text=element_text(size=13),legend.position="none")+
    geom_text(aes(label=paste(Freq,'(',per2,'%',')')),size=3,position=position_dodge(width=0.9), vjust=-0.5)
p+theme_classic()+ylab('比例')+xlab("")+
    scale_fill_discrete(name=" ")

```



###2.不同职称的熟悉和使用情况


```{r ,echo=FALSE,message=FALSE,fig.height=8,fig.width=11}
s1 <- table(sxdc$职称,sxdc$熟悉情况)
s1 <- as.data.frame(s1)
ss1 <- unstack(s1,Freq~Var2)
ss1$Var3 <- s1[1:length.POSIXlt(ss1),1]
ss1 <- filter(ss1,ss1$Var3!='')
ss1$Var4 <- round(ss1$是/(ss1$否+ss1$是),4)*100

ss1$Var5 <- ss1$否+ss1$是

ss1$Var3 <- as.character(ss1$Var3)
for (i in 1:nrow(ss1)){
  if (ss1[i,3]=="初级"){
    ss1[i,3] <- substr(ss1[i,3],1,nchar(ss1[i,3])-1)
  }
  if (ss1[i,3]=="中级"){
    ss1[i,3] <- substr(ss1[i,3],1,nchar(ss1[i,3])-1)
  }
}

wz1 <- which(ss1$Var4==max(ss1$Var4),arr.ind=F)
max1 <- ''
for(i in 1:length(wz1)){
    max1 <- paste(max1,ss1$Var3[wz1[i]],'、',sep='')   
}
max1 <- substr(max1,1,nchar(max1)-1)

wz1 <- which(ss1$Var4==min(ss1$Var4),arr.ind=T)
min1 <- ''
for(i in 1:length(wz1)){
    min1 <- paste(min1,ss1$Var3[wz1[i]],'、',sep='')   
}
min1 <- substr(min1,1,nchar(min1)-1)


s2 <- table(sxdc$职称,sxdc$使用情况)
s2 <- as.data.frame(s2)
ss2 <- unstack(s2,Freq~Var2)
ss2$Var3 <- s2[1:length.POSIXlt(ss2),1]
ss2 <- filter(ss2,Var3!='')
ss2$Var4 <- round(ss2$是/(ss2$是+ss2$否),4)*100

ss2$Var3 <- as.character(ss2$Var3)
for (i in 1:nrow(ss2)){
  if (ss2[i,3]=="初级"){
    ss2[i,3] <- substr(ss2[i,3],1,nchar(ss2[i,3])-1)
  }
  if (ss2[i,3]=="中级"){
    ss2[i,3] <- substr(ss2[i,3],1,nchar(ss2[i,3])-1)
  }
}

wz2 <- which(ss2$Var4==max(ss2$Var4),arr.ind=T)
max2 <- ''
for(i in 1:length(wz2)){
    max2 <- paste(max2,ss2$Var3[wz2[i]],'、',sep='')   
}
max2 <- substr(max2,1,nchar(max2)-1)

wz2 <- which(ss2$Var4==min(ss2$Var4),arr.ind=T)
min2 <- ''
for(i in 1:length(wz2)){
    min2 <- paste(min2,ss2$Var3[wz2[i]],'、',sep='')   
}
min2 <- substr(min2,1,nchar(min2)-1)


Title <- c('主任医师','副主任医师','住院医师','主治医师','副教授','教授')
shuxi <- as.data.frame(table(sxdc$职称,sxdc$熟悉情况))
shuxi <- subset(shuxi,subset = Var1 %in% Title)
temp <- group_by(shuxi,Var1)
ssum <- summarise(temp,sum(Freq))
names(ssum) <- c('Var1','S')
shuxi <- subset(shuxi,subset = Var2 %in% '是',select = c(Var1,Freq))
shuxi <- merge(shuxi,ssum)
shuxi$pro <- round(shuxi$Freq/shuxi$S,3)*100
shuxi$labl <- paste(shuxi$Freq,'(',shuxi$pro,'%)',sep='')
shuxi$group <- '使用'

shiyong <- as.data.frame(table(sxdc$职称,sxdc$使用情况))
shiyong <- subset(shiyong,subset = Var1 %in% Title)
temp <- group_by(shiyong,Var1)
ssum <- summarise(temp,sum(Freq))
names(ssum) <- c('Var1','S')
shiyong <- subset(shiyong,subset = Var2 %in% '是',select = c(Var1,Freq))
shiyong <- merge(shiyong,ssum)
shiyong$pro <- round(shiyong$Freq/shiyong$S,3)*100
shiyong$labl <- paste(shiyong$Freq,'(',shiyong$pro,'%)',sep='')
shiyong$group<- '熟悉'


test <- rbind(shuxi,shiyong)
test$Var1 <- factor(test$Var1,order = TRUE,levels = Title)
p1 <- ggplot(test,aes(x =Var1,y =pro,label = labl,group = factor(group),color = group,shape = group))+
    labs(x = "职称", y = "比例")
p1+
    theme_classic()+
    theme(text=element_text(size=12),plot.title=element_text(size=12))+
    geom_text(vjust = -1.5,size = 4)+
    geom_line()+
    geom_point(aes(size = 4))+
    scale_shape_manual(name  =" ",
                         values = c(7,20),
                          breaks=c("熟悉", "使用"),
                          labels=c("熟悉", "使用")
                          )+
  scale_colour_manual(name  =" ",
                         values = c('red','blue'),
                          labels=c("熟悉", "使用")
                          )+ylim(0,110)+
guides(size = FALSE)
```

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`r max1`级职称医生对标准熟悉程度最高，`r min1`级职称医生对标准熟悉程度最低。

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`r max2`级职称医生对标准使用程度最高，`r min2`级职称医生对标准使用程度最低。




##（二）专业技术水平
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;标准的专业技术水品评价包括病症诊断内容和疗效评价内容。

###1.病症诊断内容

```{r ,echo=FALSE,message=FALSE,fig.height=49,fig.width=35}
names.a <- as.character(names.a)
names.1 <- names.a[aaa1:aaa2-1]
xctm <- subset(xcdb,select = names.1)
xctm1 <- melt(xctm,measure.vars = names.1)
xctm1$value <- as.character(xctm1$value)
xctm1 <- as.data.frame(table(xctm1[,c(1,2)]))
xctm1$per <- round(xctm1$Freq/nrow(xctm),4)*100
xctm1$per2 <- round(xctm1$Freq/nrow(xctm),4)
xctm1$value <- factor(xctm1$value,order =TRUE,levels = c(1:7))

p <- ggplot(xctm1,aes(x =value,y =per2,fill = value))+
    labs(xlab = '',ylab = '频数')+
    scale_y_continuous(labels = percent,limits = c(0, 0.6))+
    geom_bar(stat = 'identity',position = 'dodge')+
    theme_few()+
    theme(text=element_text(size=37),plot.title=element_text(size=13))+
    geom_text(aes(label=paste(Freq,'(',per,'%',')')),size=6,position=position_dodge(width=0.9), vjust=-0.75)+
    facet_wrap(~variable,ncol =3)+
    scale_fill_discrete(name  ="评分")
p+ylab('频率')+xlab(" ")
    
```
###2.疗效评价内容
```{r ,echo=FALSE,message=FALSE,fig.height=15,fig.width=12}
names.2 <- names.a[aaa2:aaa3-1]
xctm <- subset(xcdb,select = names.2)
xctm1 <- melt(xctm,measure.vars = names.2)
xctm1$value <- as.character(xctm1$value)
xctm1 <- as.data.frame(table(xctm1[,c(1,2)]))
xctm1$per <- round(xctm1$Freq/nrow(xctm),4)*100
xctm1$per2 <- round(xctm1$Freq/nrow(xctm),4)
xctm1$value <- factor(xctm1$value,order =TRUE,levels = c(1:7))
#xctm1$value <- as.character(xctm1$value)
#xctm1$variable <- as.character(xctm1$variable)

p <- ggplot(xctm1,aes(x =value,y =per2,fill = value))+
    labs(xlab = '',ylab = '频数')+
    scale_y_continuous(labels = percent,limits = c(0, 0.55))+
    geom_bar(stat = 'identity',position = 'dodge')+
    theme_few()+
    theme(text=element_text(size=12),plot.title=element_text(size=4))+
    geom_text(aes(label=paste(Freq,'(',per,'%',')')),size=3,position=position_dodge(width=0.9), vjust=-0.75)+
    facet_wrap(~variable,ncol =3)+
    scale_fill_discrete(name  ="评分")
p+ylab('频率')+xlab(" ")


```

##（三）整体质量水平及适用性 

###1.整体质量水平
```{r ,echo=FALSE,message=FALSE,fig.height=20,fig.width=12}
names.3 <- names.a[aaa3:aaa4-1]
xctm <- subset(xcdb,select = names.3)
xctm1 <- melt(xctm,measure.vars = names.3)
xctm1$value <- as.character(xctm1$value)
xctm1 <- as.data.frame(table(xctm1[,c(1,2)]))
xctm1$per <- round(xctm1$Freq/nrow(xctm),4)*100
xctm1$per2 <- round(xctm1$Freq/nrow(xctm),4)
xctm1$value <- factor(xctm1$value,order =TRUE,levels = c(1:7))


p <- ggplot(xctm1,aes(x =value,y =per2,fill = value))+
    labs(xlab = '',ylab = '频数')+
    scale_y_continuous(labels = percent,limits = c(0, 0.55))+
    geom_bar(stat = 'identity',position = 'dodge')+
    theme_few()+
    theme(text=element_text(size=16),plot.title=element_text(size=13))+
    geom_text(aes(label=paste(Freq,'(',per,'%',')')),size=3,position=position_dodge(width=0.9), vjust=-0.75)+
    facet_wrap(~variable,ncol =3)+
    scale_fill_discrete(name  ="评分")
p+ylab('频率')+xlab(" ")

```
### 2.适用性评价

```{r, fig.height=5,fig.width=6}
names.4 <- names.a[aaa4:aaa4]
xctm <- subset(xcdb,select = names.4)
xctm1 <- melt(xctm,measure.vars = names.4)
xctm1$value <- as.character(xctm1$value)
xctm1 <- as.data.frame(table(xctm1[,c(1,2)]))
xctm1$per <- round(xctm1$Freq/nrow(xctm),4)*100
xctm1$per2 <- round(xctm1$Freq/nrow(xctm),4)
xctm1$value <- factor(xctm1$value,order =TRUE,levels = c(1:7))


p <- ggplot(xctm1,aes(x =value,y =per2,fill = value))+
    labs(xlab = '',ylab = '频数')+
    scale_y_continuous(labels = percent,limits = c(0, 1))+
    geom_bar(stat = 'identity',position = 'dodge')+
    theme_few()+
    theme(text=element_text(size=10),plot.title=element_text(size=13))+
    geom_text(aes(label=paste(Freq,'(',per,'%',')')),size=3,position=position_dodge(width=1), vjust=-0.75)+
    facet_wrap(~variable,ncol =2)+
    scale_fill_discrete(name  ="评分")
p+ylab('频率')+xlab("")

```
##（四）意见建议

```{r ,echo=FALSE,message=FALSE,fig.height=5,fig.width=7}
Main <- paste('图6 ','意见建议:标准最需要改进的地方',sep='') 
teat <- unlist(strsplit(as.character(xcdb$X.中医病证诊断疗效标准.修订草案的应用建议的报批或评价形式),'|',fixed = TRUE))
teat1 <- subset(teat,teat=='报批'|teat=='修改后报批'|teat=='修改后重新评价')
teat1<- as.data.frame(teat1)
names(teat1) <-'建议'
temp<- data_frame(建议 =names(table(teat1$建议)), val = as.numeric(table(teat1$建议)))
temp$pos <-cumsum(temp$val)-0.5*temp$val 
temp$per <- round(temp$val/sum(temp$val),2)*100

temp$建议 <- factor(temp$建议,order =TRUE,levels = c('修改后重新评价','修改后报批','报批'))
ggplot(temp, aes(x='',y=val,fill=建议)) +geom_bar(stat= 'identity')+
    theme_pander()+
    theme_bw()+
    theme(strip.text=element_text(size=12),axis.text.x=element_blank(),axis.ticks = element_blank(),plot.title=element_text(size=9))+
    stat_identity(geom="text", aes(label= paste(temp$val,"(",temp$per,"%)"), y = pos),size = 4)+
    coord_polar(theta = "y", direction=1)+
    labs(x = "",y = "")+
    scale_fill_discrete(name  =" ",
                          breaks=c('修改后重新评价','修改后报批','报批'),
                          labels=c('修改后重新评价','修改后报批','报批'))

```
##（五）标准适用性评价结果关联分析
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;为方便统计，将7级评分按照好（6-7分）、中等（3-5分）、差（1-2分），分别与适用性评价的相关条目进行关联分析。
###1.指南熟悉程度与质量水平评价结果的关系

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;指南熟悉程度对质量水平评价结果的影响见图9。

---
title: "适用性评价统计报告"
output: word_document
---
```{r,echo=FALSE,message=FALSE}
library(ggplot2)
library(reshape2)
library(knitr)
library(xtable)
library(dplyr)
library(scales)
library(ggthemes)
library(grid)
library(xlsx)
library(compareGroups)
library(officer)#输出漂亮的word表格
library(flextable)#输出漂亮的word表格
##设置全局选项
knit_hooks$set(margin = function(before, options, envir){
  if(before)
    par(mar = c(4, 4, 1, 0.4)) else NULL
})
opts_chunk$set(comment=NA, echo = FALSE, message=FALSE, warning=FALSE, yeshzs='asis', margin=TRUE)
options(scipen=200, digits=2)
###此处需要设置为自己的路径
setwd("C:\\Users\\zzslkbc\\Desktop\\xuexi\\2019数据")
fksysj <-read.xlsx2("妇科痛经适用性调查.xlsx", sheetName = "Sheet0")
```

```{r,echo=FALSE,message=FALSE}
output1 <- function(tab){
  for(i in 1:ncol(tab)){
  tab[, i] <- as.character(tab[, i])
}
myft <- regulartable(tab, 
     col_keys = names(tab))
myft <- set_header_labels(myft )
myft <- merge_h(myft, part = "header")
myft <- merge_v(myft, part = "header")
myft <- theme_vanilla(myft)
myft <- bg(myft, i = 1, bg = "#ADADAD", part = "header")
myft <- align(myft, align = "center", part = "all" )
myft <- border_remove(myft)
myft <- hline_top(myft, part = "header", border = fp_border(width = 1))
myft <- hline_bottom(myft, part = "header", border = fp_border(width = 1))
myft <- hline(myft, i = 1, part = "header", border = fp_border(width = 1))
myft <- hline_bottom(myft, part = "body", border = fp_border(width = 1))
myft <- autofit(myft)
myft <- width(myft,j = 1, width = 1.5)
myft
}
```
##（五）标准适用性评价结果关联分析

为方便统计，将7级评分按照好（6-7分）、中等（3-5分）、差（1-2分）。

### 1.指南熟悉程度与质量水平评价结果的关系

```{r ,echo=FALSE,message=FALSE}

aa <- colnames(fksysj)
bb <- aa[grepl("评分", aa)]
bb <- as.data.frame(bb)
bb <- as.data.frame(bb[(bb[, 1] != "是否熟悉修订前.中医病证诊断疗效标准.的内容的评分"), 1])
bb <- as.data.frame(bb[(bb[, 1] != "是否使用过修订前.中医病证诊断疗效标准.内容的评分"), 1])
bb <- as.data.frame(bb[(bb[, 1] != "视觉模拟评分法.VAS.的说明"), 1])
bb <- as.data.frame(bb[(bb[, 1] != "评分.1"), 1])
bb <- as.data.frame(bb[(bb[, 1] != "评分"), 1])
names(bb) <- "问题合集"
names.a <- bb$问题合集
bb$问题合集 <- as.character(bb$问题合集)
```

#### 1.`r unique(bb[1,1])`和医生职称之间的交互

```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[1,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)

temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=6}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[1,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[1,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，关于`r unique(bb[1,1])`评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，关于`r unique(bb[1,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，关于`r unique(bb[1,1])`评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，关于`r unique(bb[1,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`关于`r unique(bb[1,1])`评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，关于`r unique(bb[1,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，关于`r unique(bb[1,1])`评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，关于`r unique(bb[1,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，关于`r unique(bb[1,1])`评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`


```{r ,echo=FALSE,message=FALSE}
aa <- colnames(fksysj)
bb <- aa[grepl("评分", aa)]
bb <- as.data.frame(bb)
bb <- as.data.frame(bb[(bb[, 1] != "是否熟悉修订前.中医病证诊断疗效标准.的内容的评分"), 1])
bb <- as.data.frame(bb[(bb[, 1] != "是否使用过修订前.中医病证诊断疗效标准.内容的评分"), 1])
bb <- as.data.frame(bb[(bb[, 1] != "视觉模拟评分法.VAS.的说明"), 1])
bb <- as.data.frame(bb[(bb[, 1] != "评分"), 1])
bb <- as.data.frame(bb[(bb[, 1] != "评分.1"), 1])
names(bb) <- "问题合集"
names.a <- bb$问题合集

temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[1,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,4]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[1,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[1,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，关于`r unique(bb[1,1])`评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，关于`r unique(bb[1,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，关于`r unique(bb[1,1])`评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，关于`r unique(bb[1,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，关于`r unique(bb[1,1])`评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，关于`r unique(bb[1,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，关于`r unique(bb[1,1])`评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，关于`r unique(bb[1,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，关于`r unique(bb[1,1])`评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`

#### 2.`r unique(bb[2,1])`和医生职称之间的交互

```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[2,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[2,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[2,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，关于`r unique(bb[2,1])`评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，关于`r unique(bb[2,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，关于`r unique(bb[2,1])`评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，关于`r unique(bb[2,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，关于`r unique(bb[2,1])`评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，关于`r unique(bb[2,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，关于`r unique(bb[2,1])`评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，关于`r unique(bb[2,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，关于`r unique(bb[2,1])`评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`

```{r ,echo=FALSE,message=FALSE}

temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[2,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[2,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[2,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`

#### 3.`r unique(bb[3,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[3,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[3,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[3,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`
```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[3,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=12,fig.height=8}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[3,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[3,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`

#### 4.`r unique(bb[4,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[4,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[4,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[4,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`

```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[4,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[4,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[4,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`

#### 5.`r unique(bb[5,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[5,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=12,fig.height=8}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[5,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[5,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`

```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[5,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[5,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[5,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`


#### 6.`r unique(bb[6,1])`和医生职称之间的交互
```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[6,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[6,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[2,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`

```{r ,echo=FALSE,message=FALSE}

temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[6,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[6,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[6,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



#### 7.`r unique(bb[7,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[7,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[7,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[7,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`





```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[7,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[7,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[7,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`

#### 8.`r unique(bb[8,1])`和医生职称之间的交互

```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[8,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[8,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[8,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[8,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[8,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[8,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`




#### 9.`r unique(bb[9,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[9,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[9,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[9,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`





```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[9,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}    
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[9,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[9,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`





#### 10.`r unique(bb[10,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[10,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[10,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[10,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`




```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[10,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[10,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[10,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`




#### 11.`r unique(bb[11,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[11,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[11,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[11,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`中，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`




```{r ,echo=FALSE,message=FALSE}                     
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[11,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[11,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[11,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`





#### 12.`r unique(bb[12,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[12,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[12,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[12,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`




```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[12,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[12,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[12,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



#### 13.`r unique(bb[13,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[13,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[13,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[13,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`




```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[13,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[13,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[13,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`




#### 14.`r unique(bb[14,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[14,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[14,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[14,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[14,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[14,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[14,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`




#### 15.`r unique(bb[15,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[15,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[15,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[15,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[15,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[15,1])`和医生职称之间的交互。

在不熟悉标准的前提下:


`r temp3$职称[1]`中，关于`r unique(bb[15,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



#### 16.`r unique(bb[16,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[16,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[16,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[16,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`

```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[16,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[16,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[16,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`




#### 17.`r unique(bb[17,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[17,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[17,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[17,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
中，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`




```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[17,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[17,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[17,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`


#### 18.`r unique(bb[18,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[18,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[18,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[18,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[18,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[18,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[18,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`






#### 19.`r unique(bb[19,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[19,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[19,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[19,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[19,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[19,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[19,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



#### 20.`r unique(bb[20,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[20,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[20,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[20,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`




```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[20,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[20,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[20,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`




#### 21.`r unique(bb[21,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[21,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[21,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[21,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`




```{r ,echo=FALSE,message=FALSE}

temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[21,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[21,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[21,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`中，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`


#### 22`r unique(bb[22,1])`和医生职称之间的交互

```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[22,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[22,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[22,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`




```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[22,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[22,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[22,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



#### 23`r unique(bb[23,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[23,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[23,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[23,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`




```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[23,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[23,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[23,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



#### 24`r unique(bb[24,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[24,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[24,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[24,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[24,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[24,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[24,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



#### 25`r unique(bb[25,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[25,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[25,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[25,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[25,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[25,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[25,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



#### 26`r unique(bb[26,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[26,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[26,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[26,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[26,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[26,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[26,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



#### 27`r unique(bb[27,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[27,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[27,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[27,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[25,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[27,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[27,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
中，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
中，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
中，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`


#### 28`r unique(bb[28,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[28,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[28,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[28,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`中，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[28,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[28,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[28,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



#### 29`r unique(bb[29,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否熟悉修订前.中医病证诊断疗效标准.的内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[29,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为熟悉标准的内容情况下，`r unique(bb[29,1])`和医生职称之间的交互。

在熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[29,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[29,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为不熟悉标准的内容情况下，`r unique(bb[29,1])`和医生职称之间的交互。

在不熟悉标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[29,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`
，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`





### 2.指南使用程度与质量水平评价结果的关系

#### 1.`r unique(bb[1,1])`和医生职称之间的交互

```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[1,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=6}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[1,1])`和医生职称之间的交互。

在使用过标准的前提下:
`r temp3$职称[1]`中，关于`r unique(bb[1,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，关于`r unique(bb[1,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，关于`r unique(bb[1,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，关于`r unique(bb[1,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，关于`r unique(bb[1,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`


```{r ,echo=FALSE,message=FALSE}
aa <- colnames(fksysj)
bb <- aa[grepl("评分", aa)]
bb <- as.data.frame(bb)
bb <- as.data.frame(bb[(bb[, 1] != "是否熟悉修订前.中医病证诊断疗效标准.的内容的评分"), 1])
bb <- as.data.frame(bb[(bb[, 1] != "是否使用过修订前.中医病证诊断疗效标准.内容的评分"), 1])
bb <- as.data.frame(bb[(bb[, 1] != "视觉模拟评分法.VAS.的说明"), 1])
bb <- as.data.frame(bb[(bb[, 1] != "评分"), 1])
bb <- as.data.frame(bb[(bb[, 1] != "评分.1"), 1])
names(bb) <- "问题合集"
names.a <- bb$问题合集

temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[1,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,4]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[1,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[1,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，关于`r unique(bb[1,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，关于`r unique(bb[1,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，关于`r unique(bb[1,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，关于`r unique(bb[1,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`

#### 2.`r unique(bb[2,1])`和医生职称之间的交互

```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[2,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[2,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[2,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`

```{r ,echo=FALSE,message=FALSE}

temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[2,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[2,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[2,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`

#### 3.`r unique(bb[3,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[3,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[3,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[3,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`

```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[3,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=12,fig.height=8}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[3,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[3,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`

#### 4.`r unique(bb[4,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[4,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[4,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[4,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`

```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[4,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[4,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[4,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`

#### 5.`r unique(bb[5,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[5,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=12,fig.height=8}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[5,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[5,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`

```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[5,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[5,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[5,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`

#### 6.`r unique(bb[6,1])`和医生职称之间的交互
```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[6,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[6,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[6,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`

```{r ,echo=FALSE,message=FALSE}

temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[6,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[6,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[6,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`


#### 7.`r unique(bb[7,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[7,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[7,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[7,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`





```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[7,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[7,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[7,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



#### 8.`r unique(bb[8,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[8,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[8,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[8,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[8,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[8,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[8,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`

#### 9.`r unique(bb[9,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[9,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[9,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[9,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[9,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}    
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[9,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[9,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`




#### 10.`r unique(bb[10,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[10,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[10,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[10,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[10,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[10,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[10,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`

#### 11.`r unique(bb[11,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[11,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[11,1])`和医生职称之间的交互。

在使用过标准的前提下:
`r temp3$职称[1]`中，关于`r unique(bb[11,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`


```{r ,echo=FALSE,message=FALSE}                     
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[11,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[11,1])`和医生职称之间的交互。

在没有使用过标准的前提下:
`r temp3$职称[1]`中，关于`r unique(bb[11,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`


#### 12.`r unique(bb[12,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[12,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[12,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[12,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`




```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[12,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[12,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[12,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



#### 13.`r unique(bb[13,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[13,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[13,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[13,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[13,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[13,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[13,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`




#### 14.`r unique(bb[14,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[14,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[14,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[14,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[14,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[14,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[14,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



#### 15.`r unique(bb[15,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[15,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[15,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[15,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[15,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[15,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[15,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`


#### 16.`r unique(bb[16,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[16,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[16,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[16,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[16,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[16,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[16,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



#### 17.`r unique(bb[17,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[17,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[17,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[17,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[17,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[17,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[17,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



#### 18.`r unique(bb[18,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[18,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[18,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[18,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[18,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[18,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[18,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



#### 19.`r unique(bb[19,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[19,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[19,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[19,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[19,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[19,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[19,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`


#### 20.`r unique(bb[20,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[20,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[20,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[20,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[20,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[20,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[20,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



#### 21.`r unique(bb[21,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[21,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[21,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[21,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`





```{r ,echo=FALSE,message=FALSE}

temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[21,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[21,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[21,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



#### 22`r unique(bb[22,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[22,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[22,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[22,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`




```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[22,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[22,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[22,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



#### 23`r unique(bb[23,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[23,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[23,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[23,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`




```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[23,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[23,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[23,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



#### 24`r unique(bb[24,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[24,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[24,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[24,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[24,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[24,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[24,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



#### 25`r unique(bb[25,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[25,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[25,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[25,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[25,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[25,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[25,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



#### 26`r unique(bb[26,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[26,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[26,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[26,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[26,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[26,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[26,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



#### 27`r unique(bb[27,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[27,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[27,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[27,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[25,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[27,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[27,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



#### 28`r unique(bb[28,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[28,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[28,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[28,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[28,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[28,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[28,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`


#### 29`r unique(bb[29,1])`和医生职称之间的交互


```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[29,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]>5)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为使用过标准的内容情况下，`r unique(bb[29,1])`和医生职称之间的交互。

在使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[29,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`



```{r ,echo=FALSE,message=FALSE}
temp <- subset(fksysj, select = c('职称', '是否使用过修订前.中医病证诊断疗效标准.内容的评分'))
bb$问题合集 <- as.character(bb$问题合集)
temp1 <- subset(fksysj, select = bb[29,1])
temp1 <- cbind(temp, temp1)
temp1[, c(1:3)] <- lapply(temp1[, c(1:3)], as.character)
temp1[, c(2:3)] <- lapply(temp1[, c(2:3)], as.numeric)

temp1 <- filter(temp1, temp1$职称!='职称')

temp2 <- temp1
for (i in 1:length(temp1[,c(3:3)])){
  if(is.na(temp1[i,3])){
    temp2[i,3] <- '缺失'
  } else if(temp1[i,3] > 5 & temp1[i,3] <= 7){
    temp2[i,3] <- '好'                                                                                                                                                                                   
  } else if(temp1[i,3] <= 5 & temp1[i,3] >= 3){
    temp2[i,3] <- '中'
  } else{
    temp2[i,3] <- '差'
  }
}

temp2$职称 <- as.character((temp2$职称))
for (i in 1:length(temp2$职称)){
  if(temp2[i,1] == ''){
    temp2[i,1] <- '职称缺失'
  }
}
mmm <- c("好","中","差")
temp2 <- temp2[(temp2[,2]<6)&!is.na(temp2[,2]),]
temp2 <- temp2[,-2]
temp3 <- table(temp2)
temp3 <- as.data.frame(temp3)
temp3$FreqPer <- ""

for (i in 1:nrow(temp3)) {
  if(temp3$`职称`[i] == "主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主任医师", 3]), 4)*100, "%")} 
  else if(temp3$`职称`[i] == "主治医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "主治医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "住院医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "住院医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副主任医师"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副主任医师", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称`== "教授", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "职称缺失"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "职称缺失", 3]), 4)*100, "%")}
  else if(temp3$`职称`[i] == "副教授"){
    temp3$FreqPer[i] <- paste(round(temp3$Freq[i]/sum(temp3[temp3$`职称` == "副教授", 3]), 4)*100, "%")}  
}

```

```{r,echo=FALSE,message=FALSE}
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
temp4 <- temp3
names(temp4) <- c("职称","评分","Freq","FreqPer")
temp1T <- compareGroups(`评分` ~ `职称`, data = temp4, method = 3, alpha= 0.001, 
                        simplify = FALSE, ref = 2, max.ylev = 50, max.xlev = 100) 
temp1Tab <- createTable(temp1T, type = 2, digits = 2, show.all = TRUE, show.p.trend = F,
                        show.ratio = FALSE, show.p.overall = FALSE, show.n = TRUE,
                        sd.type = 2, q.type = c(1,2))
tabl <- as.data.frame(temp1Tab$descr)
tabl[, ncol(tabl)+1] <- rownames(tabl)
tabl <- tabl[, c(ncol(tabl), 1:(ncol(tabl)-1))]
names(tabl)[1] <- "职称"
output1(tabl)
```

```{r,echo=FALSE,message=FALSE,fig.width=9,fig.height=5}
# create a dataset
职称 <- temp3$职称 
评价 <- temp3[,2]
人数 <- temp3$Freq
人数lv <- temp3$FreqPer
data <- data.frame(职称, 评价, 人数)
# Grouped
ggplot(data, aes(x=职称, y=factor(人数))) + 
  geom_bar(aes(fill=评价), position="dodge", stat="identity")+
  geom_line(aes(colour=评价, group=评价), position=position_dodge(width=0.9))+
  geom_point(aes(colour=评价), position=position_dodge(width=0.9))+
  geom_text(aes(label=paste(人数, "(", 人数lv, ")")), size=4, col="black", vjust=-0.35)+
  ylab("人数")+xlab("职称")
```

上图为没有使用过标准的内容情况下，`r unique(bb[29,1])`和医生职称之间的交互。

在没有使用过标准的前提下:

`r temp3$职称[1]`中，关于`r unique(bb[29,1])`评价为`r temp3[1,2]`的人数为`r temp3$Freq[1]`,占比`r temp3$FreqPer[1]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[7]`,占比`r temp3$FreqPer[7]`

`r temp3$职称[2]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[2]`,占比`r temp3$FreqPer[2]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[8]`,占比`r temp3$FreqPer[8]`

`r temp3$职称[3]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[3]`,占比`r temp3$FreqPer[3]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[9]`,占比`r temp3$FreqPer[9]`

`r temp3$职称[4]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[4]`,占比`r temp3$FreqPer[4]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[10]`,占比`r temp3$FreqPer[10]`

`r temp3$职称[5]`中，评价为`r temp3[1,2]`的人数为`r temp3$Freq[5]`,占比`r temp3$FreqPer[5]`，评价为`r temp3[7,2]`的人数为`r temp3$Freq[11]`,占比`r temp3$FreqPer[11]`




